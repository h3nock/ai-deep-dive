@import "tailwindcss";

/* ==========================================================================
   Eye-Safe Theme Configuration (Tailwind v4 CSS-First)
   HARD LOCKED TO DARK MODE - No light mode support
   Optimized for 4+ hour reading sessions
   ========================================================================== */

/* Force dark mode at CSS level - ignore system preferences */
:root {
  color-scheme: dark !important;
  
  /* ==========================================================================
     4-TIER SPACING SYSTEM (Gestalt-Driven)
     
     Whitespace is the primary structural element in our "Void" layout.
     Proximity = Relationship. Never use random values.
     ========================================================================== */
  
  /* TIER 1: Atomic Gap (Tightest)
     Purpose: Glue a label/caption to its data. Single visual unit.
     Use for: Header + Subheader, Figure label + Image, Meta text + Component
     Theory: Eye captures both in single fixation without moving. */
  --space-atomic: 0.5rem;      /* 8px */
  
  /* TIER 2: Connected Gap (The Magnet)
     Purpose: Connect intro sentence to the object it introduces.
     Use for: "Here is the code:" → [Code Block], Description → Visualization
     Theory: Visibly smaller than paragraph spacing. Acts as magnet. */
  --space-connected: 1rem;     /* 16px */
  
  /* TIER 3: Flow Gap (Standard)
     Purpose: Breathing room between thoughts while maintaining narrative.
     Use for: Between paragraphs, standard content rhythm.
     Theory: Large enough to distinguish blocks, small enough to show continuity. */
  --space-flow: 1.5rem;        /* 24px */
  
  /* TIER 4: Section Gap (The Break)
     Purpose: Signal hard reset / topic change.
     Use for: Between major sections, end of concept → start of next headline.
     Theory: Massive gap replaces horizontal dividers in Void layout. */
  --space-section: 3rem;       /* 48px */
  
  /* Extended scale for extra-large breaks */
  --space-section-lg: 4rem;    /* 64px - between Steps */
}

@media (prefers-color-scheme: light) {
  :root {
    color-scheme: dark !important;
  }
}

@theme inline {
  /* THE CANVAS - Warm enough to avoid blue light strain, dark enough for immersion */
  --color-background: #09090B; /* Zinc-950 */
  --color-surface: #18181B;    /* Zinc-900 (Cards/Sidebars) */
  
  /* THE TEXT HIERARCHY - Night Reading Optimized (No Glow/Bloom) */
  --color-primary: #D4D4D8;    /* Zinc-300 (Headings - soft, no halation) */
  --color-secondary: #A1A1AA;  /* Zinc-400 (Body text) */
  --color-muted: #71717A;      /* Zinc-500 (Meta/Captions) */
  --color-border: #27272A;     /* Zinc-800 (Dividers) */
  
  /* SEMANTIC STATES - Correct/Error feedback */
  --color-success: #34D399;    /* Emerald-400 (Correct states) */
  --color-error: #FB7185;      /* Rose-400 (Error states) */
  
  /* Legacy support */
  --color-foreground: var(--color-secondary);
  
  /* Typography */
  --font-sans: var(--font-geist-sans), "Geist Sans", "Inter", sans-serif;
  --font-mono: var(--font-geist-mono), "Geist Mono", "JetBrains Mono", monospace;
}

body {
  background: var(--color-background);
  color: var(--color-secondary);
  font-family: var(--font-sans);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ==========================================================================
   Base Typography - Eye-Safe Reading Configuration
   ========================================================================== */

@layer base {
  /* THE READING PARAGRAPH - Most important class for course content */
  p {
    @apply text-lg;           /* 18px (Standard 16px too small for long sessions) */
    @apply leading-relaxed;   /* 1.75 Line Height (Lets the eye breathe) */
    @apply tracking-wide;     /* +0.025em (Prevents letters merging in glow) */
    @apply font-normal;       /* Weight 400 (NEVER use Light/300) */
    @apply max-w-[85ch];      /* Max 85 characters wide (Technical docs standard - fits code snippets) */
  }
  
  /* Headings - High contrast for scanning */
  h1, h2, h3, h4, h5, h6 {
    color: var(--color-primary);
    @apply font-semibold;
  }
  
  /* Meta text - Low noise */
  small, .text-muted {
    color: var(--color-muted);
  }
  
  /* CODE BLOCKS - Deep Tech Terminal Style */
  pre {
    @apply text-[0.875rem];
    background-color: #121212 !important; /* Slightly lighter than page void */
    border: 1px solid #27272A; /* Zinc-800 - subtle edge */
    border-radius: 0.5rem;
  }
  
  code {
    @apply text-[0.875em];
    font-family: var(--font-mono);
  }
}

/* Professional Grid Pattern */
.bg-grid-pattern {
  background-size: 40px 40px;
  background-image: linear-gradient(to right, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
}

/* Subtle Gradient Animation */
@keyframes gradient-shift {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

.animate-gradient-shift {
  background-size: 200% 200%;
  animation: gradient-shift 8s ease infinite;
}

/* Custom Scrollbar Styles - Eye-Safe Zinc Theme */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: #09090B; /* Matches --color-background */
  border-radius: 5px;
}

::-webkit-scrollbar-thumb {
  background: #27272A; /* Matches --color-border (Zinc-800) */
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: #3f3f46; /* Zinc-700 */
}

/* Code Block Styling - rehype-pretty-code (Deep Tech Terminal Style)
   SPACING: Uses Component Sandwich pattern (connected top, flow bottom) */
[data-rehype-pretty-code-figure] {
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
}

[data-rehype-pretty-code-figure] pre {
  padding: 1rem 1.25rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  font-size: 0.875rem;
  line-height: 1.7;
  background-color: #121212 !important; /* Slightly lighter than page void */
  border: 1px solid #27272A; /* Zinc-800 - subtle edge */
}

[data-rehype-pretty-code-figure] code {
  font-family: var(--font-mono), ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
  font-size: 0.875rem;
  background: transparent !important;
}

/* Code block with title/caption - uses Atomic gap */
[data-rehype-pretty-code-title] {
  padding: 0.5rem 1rem;
  font-size: 0.75rem;
  font-family: var(--font-mono);
  color: #71717A; /* Zinc-500 (muted) */
  background-color: #121212;
  border: 1px solid #27272A;
  border-bottom: none;
  border-radius: 0.5rem 0.5rem 0 0;
}

[data-rehype-pretty-code-title] + pre {
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  margin-top: 0 !important;
}

/* Inline code - Eye-Safe */
:not(pre) > code {
  padding: 0.2em 0.4em;
  border-radius: 0.25rem;
  font-size: 0.875em;
  background-color: #18181B; /* Zinc-900 (surface) */
  color: #D4D4D8; /* Zinc-300 (secondary) */
}

/* ==========================================================================
   Prose Overrides - Night Reading Safe (No Glow/Bloom)
   4-Tier Spacing Applied
   ========================================================================== */

.prose {
  --tw-prose-body: #A1A1AA;           /* Zinc-400 */
  --tw-prose-headings: #D4D4D8;       /* Zinc-300 (same as primary - no bright whites) */
  --tw-prose-lead: #A1A1AA;           /* Zinc-400 */
  --tw-prose-links: #D4D4D8;          /* Zinc-300 */
  --tw-prose-bold: #D4D4D8;           /* Zinc-300 (matches headings - no bloom) */
  --tw-prose-counters: #71717A;       /* Zinc-500 (muted) */
  --tw-prose-bullets: #52525B;        /* Zinc-600 */
  --tw-prose-hr: #27272A;             /* Zinc-800 (border) */
  --tw-prose-quotes: #A1A1AA;         /* Zinc-400 */
  --tw-prose-quote-borders: #27272A;  /* Zinc-800 */
  --tw-prose-captions: #71717A;       /* Zinc-500 (muted) */
  --tw-prose-code: #A1A1AA;           /* Zinc-400 (same as body) */
  --tw-prose-pre-code: #A1A1AA;       /* Zinc-400 */
  --tw-prose-pre-bg: #121212;         /* Code void */
  --tw-prose-th-borders: #27272A;     /* Zinc-800 */
  --tw-prose-td-borders: #27272A;     /* Zinc-800 */
}

/* Prose Paragraphs - Tier 3 (Flow) spacing */
.prose p {
  margin-bottom: var(--space-flow);
}

.prose p:last-child {
  margin-bottom: 0;
}

/* Prose Headings - Section breaks with connected content */
.prose h2 {
  margin-top: var(--space-section);
  margin-bottom: var(--space-connected);
}

.prose h3 {
  margin-top: var(--space-section);
  margin-bottom: var(--space-connected);
}

.prose h4 {
  margin-top: var(--space-flow);
  margin-bottom: var(--space-atomic);
}

/* First heading after section start - no extra top margin */
.prose h2:first-child,
.prose h3:first-child,
.prose h4:first-child {
  margin-top: 0;
}

/* Prose Lists - Flow spacing */
.prose ul, .prose ol {
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
}

.prose li {
  margin-top: var(--space-atomic);
  margin-bottom: var(--space-atomic);
}

/* Table Styling - Component Sandwich (connected top, flow bottom) */
.prose table {
  width: 100%;
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
  border-collapse: collapse;
  font-size: 0.875rem;
}

.prose thead {
  background-color: #18181B; /* Zinc-900 (surface) */
}

.prose th {
  padding: 0.75rem 1rem;
  text-align: left;
  font-weight: 500;
  color: #D4D4D8; /* Primary */
  border-bottom: 1px solid #27272A;
}

.prose td {
  padding: 0.75rem 1rem;
  color: #A1A1AA; /* Secondary */
  border-bottom: 1px solid #27272A;
}

.prose tbody tr:last-child td {
  border-bottom: none;
}

.prose table code {
  font-size: 0.8125rem;
  padding: 0.125rem 0.375rem;
  background-color: #27272A; /* Zinc-800 */
  border-radius: 0.25rem;
}

/* Override prose-invert since we're dark-only */
.prose-invert {
  --tw-prose-body: #A1A1AA;
  --tw-prose-headings: #D4D4D8;
  --tw-prose-lead: #A1A1AA;
  --tw-prose-links: #D4D4D8;
  --tw-prose-bold: #D4D4D8;           /* No bloom - same as headings */
  --tw-prose-counters: #71717A;
  --tw-prose-bullets: #52525B;
  --tw-prose-hr: #27272A;
  --tw-prose-quotes: #A1A1AA;
  --tw-prose-quote-borders: #27272A;
  --tw-prose-captions: #71717A;
  --tw-prose-code: #A1A1AA;
  --tw-prose-pre-code: #A1A1AA;
  --tw-prose-pre-bg: #121212;
  --tw-prose-th-borders: #27272A;
  --tw-prose-td-borders: #27272A;
}

/* ==========================================================================
   Linear/Vercel-Style Card Hover Effects
   Border-driven glow with stable background
   ========================================================================== */

/* Card Glow Container - handles the glow effect on border */
.card-glow {
  --glow-color: rgba(161, 161, 170, 0); /* Zinc-400 at 0% */
  position: relative;
  border-radius: 0.75rem;
  transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* The glow ring - positioned behind the card */
.card-glow::before {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(
    135deg,
    var(--glow-color),
    transparent 40%,
    transparent 60%,
    var(--glow-color)
  );
  -webkit-mask: 
    linear-gradient(#fff 0 0) content-box, 
    linear-gradient(#fff 0 0);
  mask: 
    linear-gradient(#fff 0 0) content-box, 
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity: 0;
  transition: opacity 300ms cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
}

/* Hover state - activate the glow */
.card-glow:hover {
  --glow-color: rgba(161, 161, 170, 0.5); /* Zinc-400 at 50% */
}

.card-glow:hover::before {
  opacity: 1;
}

/* Subtle box shadow glow for depth */
.card-glow:hover {
  box-shadow: 
    0 0 0 1px rgba(161, 161, 170, 0.15),
    0 4px 24px -4px rgba(0, 0, 0, 0.4),
    0 0 40px -8px rgba(161, 161, 170, 0.1);
}

/* Interactive variant - for clickable cards */
.card-glow-interactive {
  cursor: pointer;
}

.card-glow-interactive:hover {
  --glow-color: rgba(212, 212, 216, 0.4); /* Zinc-300 - slightly brighter for interactive */
  transform: translateY(-2px);
}

.card-glow-interactive:hover::before {
  opacity: 1;
}

.card-glow-interactive:active {
  transform: translateY(0);
  transition-duration: 100ms;
}

/* Disabled state */
.card-glow-disabled {
  cursor: default;
}

.card-glow-disabled:hover {
  --glow-color: rgba(161, 161, 170, 0);
  transform: none;
  box-shadow: none;
}

.card-glow-disabled:hover::before {
  opacity: 0;
}

/* ==========================================================================
   Semantic Spacing Utilities for MDX Content
   Use these instead of raw my-*, mt-*, mb-* when possible
   ========================================================================== */

/* Component Wrapper - Standard block with asymmetric "sandwich" spacing */
.content-block {
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
}

/* Section Wrapper - Major topic change */
.section-block {
  margin-top: var(--space-section);
  margin-bottom: var(--space-section);
}

/* Caption/Label that precedes a component */
.content-label {
  margin-bottom: var(--space-atomic);
}

/* Internal h4 headings within Steps */
.content-heading {
  margin-top: var(--space-flow);
  margin-bottom: var(--space-atomic);
}

/* ==========================================================================
   Content Attached Pattern
   Use when a paragraph ending with ":" introduces a table, code block, or container.
   The content is semantically part of the paragraph (an illustration/example).
   ========================================================================== */

/* Wrapper for content directly attached to intro paragraph */
.content-attached {
  margin-top: var(--space-atomic) !important;
  margin-bottom: var(--space-flow);
}

/* Remove any internal top margins from prose elements */
.content-attached table,
.content-attached pre,
.content-attached .prose table,
.content-attached .prose pre {
  margin-top: 0 !important;
}

/* Legacy alias - use content-attached instead */
.table-attached {
  margin-top: var(--space-atomic) !important;
}

.table-attached table {
  margin-top: 0 !important;
}

/* ==========================================================================
   Debug Utility - Uncomment to find pure white/black violations
   ========================================================================== */
/* 
.debug-contrast * {
  outline: 1px solid red;
}
*/

/* ==========================================================================
   Monaco Editor Overrides
   Ensures no white flash during editor loading
   ========================================================================== */

/* Monaco editor wrapper - force dark background immediately */
.monaco-editor,
.monaco-editor-background,
.monaco-editor .overflow-guard {
  background-color: #09090B !important;
}

/* Monaco loader wrapper (before editor is ready) */
section[style*="display: flex"][style*="justify-content: center"] {
  background-color: #09090B !important;
}

/* Force all Monaco internal containers to use dark background */
.monaco-editor .margin,
.monaco-editor .monaco-scrollable-element {
  background-color: #09090B !important;
}