@import "tailwindcss";

/* ==========================================================================
   Eye-Safe Theme Configuration (Tailwind v4 CSS-First)
   Supports dark (default) and light modes via class on <html>
   Dark mode optimized for 4+ hour reading sessions
   ========================================================================== */

:root {
  /* ==========================================================================
     4-TIER SPACING SYSTEM (Gestalt-Driven)

     Whitespace is the primary structural element in our "Void" layout.
     Proximity = Relationship. Never use random values.
     ========================================================================== */

  /* TIER 1: Atomic Gap (Tightest)
     Purpose: Glue a label/caption to its data. Single visual unit.
     Use for: Header + Subheader, Figure label + Image, Meta text + Component
     Theory: Eye captures both in single fixation without moving. */
  --space-atomic: 0.5rem;
  /* 8px */

  /* TIER 2: Connected Gap (The Magnet)
     Purpose: Connect intro sentence to the object it introduces.
     Use for: "Here is the code:" → [Code Block], Description → Visualization
     Theory: Visibly smaller than paragraph spacing. Acts as magnet. */
  --space-connected: 1rem;
  /* 16px */

  /* TIER 3: Flow Gap (Standard)
     Purpose: Breathing room between thoughts while maintaining narrative.
     Use for: Between paragraphs, standard content rhythm.
     Theory: Large enough to distinguish blocks, small enough to show continuity. */
  --space-flow: 1.5rem;
  /* 24px */

  /* TIER 4: Section Gap (The Break)
     Purpose: Signal hard reset / topic change.
     Use for: Between major sections, end of concept → start of next headline.
     Theory: Massive gap replaces horizontal dividers in Void layout. */
  --space-section: 3rem;
  /* 48px */

  /* Extended scale for extra-large breaks */
  --space-section-lg: 4rem;
  /* 64px - between Steps */
}

/* Dark mode (default) */
:root,
.dark {
  color-scheme: dark;
}

/* Light mode */
.light {
  color-scheme: light;
}

/* -------------------------------------------------------------------------
   @theme (not inline) outputs CSS custom properties at :root AND generates
   utilities that reference var(--color-*). This lets .light overrides
   swap values at runtime.
   ------------------------------------------------------------------------- */
@theme {
  --color-background: #09090B;       /* Zinc-950 */
  --color-surface: #18181B;          /* Zinc-900 (Cards/Sidebars) */
  --color-primary: #D4D4D8;          /* Zinc-300 (Headings) */
  --color-secondary: #A1A1AA;        /* Zinc-400 (Body text) */
  --color-muted: #71717A;            /* Zinc-500 (Meta/Captions) */
  --color-border: #27272A;           /* Zinc-800 (Dividers) */
  --color-border-hover: #3f3f46;     /* Zinc-700 (Hover state borders) */
  --color-terminal: #121212;         /* Code blocks, data containers */
  --color-success: #34D399;          /* Emerald-400 */
  --color-error: #FB7185;            /* Rose-400 */
  --color-warning: #FBBF24;          /* Amber-400 */
  --color-info: #38BDF8;             /* Sky-400 */
  --color-primary-hover: #E4E4E7;    /* Zinc-200 (Filled button hover) */

  /* Accent palette — ordinal tokens for illustrations/categorisation */
  --color-accent-1: #10B981;         /* Emerald-500 */
  --color-accent-2: #60A5FA;         /* Blue-400 */
  --color-accent-3: #FB7185;         /* Rose-400 */
  --color-accent-4: #FBBF24;         /* Amber-400 */
  --color-accent-5: #A855F7;         /* Purple-400 */
  --color-accent-6: #22D3EE;         /* Cyan-400 */
  --color-on-accent: #09090B;        /* Dark text for solid accent fills */
  --color-foreground: var(--color-secondary);

  /* Typography */
  --font-sans: var(--font-geist-sans), "Geist Sans", "Inter", sans-serif;
  --font-mono: var(--font-geist-mono), "Geist Mono", "JetBrains Mono", monospace;
}

/* -------------------------------------------------------------------------
   Light palette — overrides the @theme tokens when .light is on <html>.
   Designed for comfortable daytime reading with the same hierarchy.
   ------------------------------------------------------------------------- */
.light {
  --color-background: #ffffff;
  --color-surface: #f4f4f5;          /* Zinc-100 */
  --color-primary: #18181B;          /* Zinc-900 (Headings) */
  --color-secondary: #3f3f46;        /* Zinc-700 (Body text) */
  --color-muted: #71717A;            /* Zinc-500 (Meta/Captions) */
  --color-border: #e4e4e7;           /* Zinc-200 (Dividers) */
  --color-border-hover: #d4d4d8;     /* Zinc-300 (Hover state borders) */
  --color-terminal: #f9fafb;         /* Gray-50 (Code blocks) */
  --color-success: #047857;          /* Emerald-700 */
  --color-error: #be123c;            /* Rose-700 */
  --color-warning: #b45309;          /* Amber-700 */
  --color-info: #0369a1;             /* Sky-700 */
  --color-primary-hover: #27272A;    /* Zinc-800 (Filled button hover) */

  --color-accent-1: #047857;         /* Emerald-700 */
  --color-accent-2: #1d4ed8;         /* Blue-700 */
  --color-accent-3: #be123c;         /* Rose-700 */
  --color-accent-4: #b45309;         /* Amber-700 */
  --color-accent-5: #6d28d9;         /* Purple-700 */
  --color-accent-6: #0e7490;         /* Cyan-700 */
  --color-on-accent: #ffffff;        /* White text for solid accent fills */
  --color-foreground: var(--color-secondary);
}

body {
  background: var(--color-background);
  color: var(--color-secondary);
  font-family: var(--font-sans);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ==========================================================================
   Base Typography - Eye-Safe Reading Configuration
   ========================================================================== */

@layer base {

  /* THE READING PARAGRAPH - Most important class for course content */
  p {
    @apply text-lg;
    /* 18px (Standard 16px too small for long sessions) */
    @apply leading-relaxed;
    /* 1.75 Line Height (Lets the eye breathe) */
    @apply tracking-wide;
    /* +0.025em (Prevents letters merging in glow) */
    @apply font-normal;
    /* Weight 400 (NEVER use Light/300) */
    @apply max-w-[85ch];
    /* Max 85 characters wide (Technical docs standard - fits code snippets) */
  }

  /* Headings - High contrast for scanning */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--color-primary);
    @apply font-semibold;
  }

  /* Meta text - Low noise */
  small,
  .text-muted {
    color: var(--color-muted);
  }

  /* CODE BLOCKS - Deep Tech Terminal Style */
  pre {
    @apply text-[0.875rem];
    background-color: var(--color-terminal) !important;
    border: 1px solid var(--color-border);
    border-radius: 0.5rem;
  }

  code {
    @apply text-[0.875em];
    font-family: var(--font-mono);
  }
}

/* Professional Grid Pattern */
.bg-grid-pattern {
  background-size: 40px 40px;
  background-image: linear-gradient(to right, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
}

.light .bg-grid-pattern {
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.05) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
}

/* Subtle Gradient Animation */
@keyframes gradient-shift {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

.animate-gradient-shift {
  background-size: 200% 200%;
  animation: gradient-shift 8s ease infinite;
}

/* Custom Scrollbar Styles - Eye-Safe Zinc Theme */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: var(--color-background);
  border-radius: 5px;
}

::-webkit-scrollbar-thumb {
  background: var(--color-border);
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-border-hover);
}

/* ==========================================================================
   Shiki Multi-Theme Toggle
   rehype-pretty-code generates --shiki-dark and --shiki-light on each span.
   Default to dark; .light selector switches to light values.
   ========================================================================== */
code[data-theme*=" "],
code[data-theme*=" "] span {
  color: var(--shiki-dark);
}

.light code[data-theme*=" "],
.light code[data-theme*=" "] span {
  color: var(--shiki-light);
}

/* Code Block Styling - rehype-pretty-code (Deep Tech Terminal Style)
   SPACING: Uses Component Sandwich pattern (connected top, flow bottom) */
[data-rehype-pretty-code-figure] {
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
}

[data-rehype-pretty-code-figure] pre {
  padding: 1rem 1.25rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  font-size: 0.875rem;
  line-height: 1.7;
  background-color: var(--color-terminal) !important;
  border: 1px solid var(--color-border);
}

[data-rehype-pretty-code-figure] code {
  font-family: var(--font-mono), ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
  font-size: 0.875rem;
  background: transparent !important;
}

/* Code block with title/caption - uses Atomic gap */
[data-rehype-pretty-code-title] {
  padding: 0.5rem 1rem;
  font-size: 0.75rem;
  font-family: var(--font-mono);
  color: var(--color-muted);
  background-color: var(--color-terminal);
  border: 1px solid var(--color-border);
  border-bottom: none;
  border-radius: 0.5rem 0.5rem 0 0;
}

[data-rehype-pretty-code-title]+pre {
  border-top-left-radius: 0;
  border-top-right-radius: 0;
  margin-top: 0 !important;
}

/* Inline code - Eye-Safe */
:not(pre)>code {
  padding: 0.2em 0.4em;
  border-radius: 0.25rem;
  font-size: 0.875em;
  background-color: var(--color-surface);
  color: var(--color-primary);
}

/* ==========================================================================
   Prose Overrides - Theme-Aware
   4-Tier Spacing Applied
   ========================================================================== */

.prose,
.prose-invert {
  --tw-prose-body: var(--color-secondary);
  --tw-prose-headings: var(--color-primary);
  --tw-prose-lead: var(--color-secondary);
  --tw-prose-links: var(--color-primary);
  --tw-prose-bold: var(--color-primary);
  --tw-prose-counters: var(--color-muted);
  --tw-prose-bullets: var(--color-muted);
  --tw-prose-hr: var(--color-border);
  --tw-prose-quotes: var(--color-secondary);
  --tw-prose-quote-borders: var(--color-border);
  --tw-prose-captions: var(--color-muted);
  --tw-prose-code: var(--color-secondary);
  --tw-prose-pre-code: var(--color-secondary);
  --tw-prose-pre-bg: var(--color-terminal);
  --tw-prose-th-borders: var(--color-border);
  --tw-prose-td-borders: var(--color-border);
}

/* Prose Paragraphs - Tier 3 (Flow) spacing */
.prose p {
  margin-bottom: var(--space-flow);
}

.prose p:last-child {
  margin-bottom: 0;
}

/* Prose Headings - Section breaks with connected content */
.prose h2 {
  margin-top: var(--space-section);
  margin-bottom: var(--space-connected);
}

.prose h3 {
  margin-top: var(--space-section);
  margin-bottom: var(--space-connected);
}

.prose h4 {
  margin-top: var(--space-flow);
  margin-bottom: var(--space-atomic);
}

/* First heading after section start - no extra top margin */
.prose h2:first-child,
.prose h3:first-child,
.prose h4:first-child {
  margin-top: 0;
}

/* Prose Lists - Flow spacing */
.prose ul,
.prose ol {
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
}

.prose li {
  margin-top: var(--space-atomic);
  margin-bottom: var(--space-atomic);
}

/* Table Styling - Component Sandwich (connected top, flow bottom) */
.prose table {
  width: 100%;
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
  border-collapse: collapse;
  font-size: 0.875rem;
}

.prose thead {
  background-color: var(--color-surface);
}

.prose th {
  padding: 0.75rem 1rem;
  text-align: left;
  font-weight: 500;
  color: var(--color-primary);
  border-bottom: 1px solid var(--color-border);
}

.prose td {
  padding: 0.75rem 1rem;
  color: var(--color-secondary);
  border-bottom: 1px solid var(--color-border);
}

.prose tbody tr:last-child td {
  border-bottom: none;
}

.prose table code {
  font-size: 0.8125rem;
  padding: 0.125rem 0.375rem;
  background-color: var(--color-border);
  border-radius: 0.25rem;
}

/* prose-invert is unified with .prose above — both use CSS custom properties
   that automatically adapt to the active theme. */

/* Inline code - slightly smaller than body text but readable */
.prose :not(pre)>code {
  font-size: 0.9375rem;
  /* 15px - close to body text */
  padding: 0.125rem 0.375rem;
  background-color: var(--color-border);
  border-radius: 0.25rem;
  font-feature-settings: normal;
}

/* Ensure list items match paragraph font size */
.prose li {
  font-size: inherit;
}

/* ==========================================================================
   Linear/Vercel-Style Card Hover Effects
   Border-driven glow with stable background
   ========================================================================== */

/* Card Glow Container - handles the glow effect on border
   Uses CSS custom properties so light/dark themes get different glow tones */
.card-glow {
  --glow-color: transparent;
  --glow-shadow-ring: rgba(161, 161, 170, 0.15);
  --glow-shadow-depth: rgba(0, 0, 0, 0.4);
  --glow-shadow-spread: rgba(161, 161, 170, 0.1);
  position: relative;
  border-radius: 0.75rem;
  transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);
}

.light .card-glow {
  --glow-shadow-ring: rgba(0, 0, 0, 0.08);
  --glow-shadow-depth: rgba(0, 0, 0, 0.12);
  --glow-shadow-spread: rgba(0, 0, 0, 0.04);
}

/* The glow ring - positioned behind the card */
.card-glow::before {
  content: '';
  position: absolute;
  inset: -1px;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(135deg,
      var(--glow-color),
      transparent 40%,
      transparent 60%,
      var(--glow-color));
  -webkit-mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  mask:
    linear-gradient(#fff 0 0) content-box,
    linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity: 0;
  transition: opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);
  pointer-events: none;
}

/* Hover state - activate the glow */
.card-glow:hover {
  --glow-color: rgba(161, 161, 170, 0.5);
}

.light .card-glow:hover {
  --glow-color: rgba(0, 0, 0, 0.15);
}

.card-glow:hover::before {
  opacity: 1;
}

/* Subtle box shadow glow for depth */
.card-glow:hover {
  box-shadow:
    0 0 0 1px var(--glow-shadow-ring),
    0 4px 24px -4px var(--glow-shadow-depth),
    0 0 40px -8px var(--glow-shadow-spread);
}

/* Interactive variant - for clickable cards */
.card-glow-interactive {
  cursor: pointer;
}

.card-glow-interactive:hover {
  --glow-color: rgba(212, 212, 216, 0.4);
  transform: translateY(-1px);
}

.light .card-glow-interactive:hover {
  --glow-color: rgba(0, 0, 0, 0.2);
}

.card-glow-interactive:hover::before {
  opacity: 1;
}

.card-glow-interactive:active {
  transform: translateY(0);
  transition-duration: 100ms;
}

/* Disabled state */
.card-glow-disabled {
  cursor: default;
}

.card-glow-disabled:hover {
  --glow-color: transparent;
  transform: none;
  box-shadow: none;
}

.card-glow-disabled:hover::before {
  opacity: 0;
}

/* ==========================================================================
   Semantic Spacing Utilities for MDX Content
   Use these instead of raw my-*, mt-*, mb-* when possible
   ========================================================================== */

/* Component Wrapper - Standard block with asymmetric "sandwich" spacing */
.content-block {
  margin-top: var(--space-connected);
  margin-bottom: var(--space-flow);
}

/* Section Wrapper - Major topic change */
.section-block {
  margin-top: var(--space-section);
  margin-bottom: var(--space-section);
}

/* Caption/Label that precedes a component */
.content-label {
  margin-bottom: var(--space-atomic);
}

/* Internal h4 headings within Steps */
.content-heading {
  margin-top: var(--space-flow);
  margin-bottom: var(--space-atomic);
}

/* ==========================================================================
   Content Attached Pattern
   Use when a paragraph ending with ":" introduces a table, code block, or container.
   The content is semantically part of the paragraph (an illustration/example).
   ========================================================================== */

/* Wrapper for content directly attached to intro paragraph */
.content-attached {
  margin-top: var(--space-atomic) !important;
  margin-bottom: var(--space-flow);
}

/* Remove any internal top margins from prose elements */
.content-attached table,
.content-attached pre,
.content-attached .prose table,
.content-attached .prose pre {
  margin-top: 0 !important;
}

/* Legacy alias - use content-attached instead */
.table-attached {
  margin-top: var(--space-atomic) !important;
}

.table-attached table {
  margin-top: 0 !important;
}

/* ==========================================================================
   Debug Utility - Uncomment to find pure white/black violations
   ========================================================================== */
/* 
.debug-contrast * {
  outline: 1px solid red;
}
*/

/* ==========================================================================
   Monaco Editor Overrides
   Ensures no background flash during editor loading
   ========================================================================== */

/* Monaco editor wrapper - force theme background immediately */
.monaco-editor,
.monaco-editor-background,
.monaco-editor .overflow-guard {
  background-color: var(--color-background) !important;
}

/* Monaco loader wrapper (before editor is ready) */
section[style*="display: flex"][style*="justify-content: center"] {
  background-color: var(--color-background) !important;
}

/* Force all Monaco internal containers to use theme background */
.monaco-editor .margin,
.monaco-editor .monaco-scrollable-element {
  background-color: var(--color-background) !important;
}

/* ==========================================================================
   KaTeX Math Formula Styling
   Integrates with prose typography - formulas should not overpower text
   ========================================================================== */

/* Display math ($$...$$) */
.prose .katex-display {
  margin: 1rem 0;
  overflow-x: auto;
  overflow-y: hidden;
  text-align: left;
}

/* Scale formulas to match prose text hierarchy */
.prose .katex-display>.katex,
.prose .katex {
  font-size: 1rem !important;
  /* Match prose base size */
  color: var(--color-secondary) !important;
}

/* Ensure all KaTeX elements inherit the secondary color */
.prose .katex * {
  color: inherit !important;
}

/* Fraction bars */
.prose .katex .frac-line {
  border-bottom-color: var(--color-secondary) !important;
}

.prose .katex .sqrt>.sqrt-line {
  border-top-color: var(--color-secondary) !important;
}